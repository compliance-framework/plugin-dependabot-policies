package compliance_framework.vulnerability_patch_available

violation[{}] if {
	# Build a set of alerts that have been dismissed, but a patch is available
	dismissed_alerts := [alert |
		alert := input.alerts[_]
		alert.dismissed_at != null
		alert.security_vulnerability.first_patched_version != null
	]

	# If there are 1 or more such alerts, then deny.
	count(dismissed_alerts) >= 1
}

title := "Limit dismissed vulnerabilities with a patch available"
description := "Vulnerabilities that have a patch available should not be dismissed and updated instead."
