package compliance_framework.vulnerability_dismissal_count

test_no_vulnerabilities_ok if {
	count(violation) == 0 with input as {"alerts": []}
}

test_few_vulnerabilities_ok if {
	count(violation) == 0 with input as {"alerts": [
		{"state": "closed"},
		{"state": "dismissed"},
		{"state": "open"},
	]}
}

test_nine_vulnerabilities_ok if {
	count(violation) == 0 with input as {"alerts": [
		{"state": "closed"},
		{"state": "dismissed"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
	]}
}

test_ten_vulnerabilities_violation if {
	count(violation) == 0 with input as {"alerts": [
		{"state": "closed"},
		{"state": "dismissed"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
	]}
}

test_eleven_vulnerabilities_violation if {
	count(violation) == 0 with input as {"alerts": [
		{"state": "closed"},
		{"state": "dismissed"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
	]}
}
