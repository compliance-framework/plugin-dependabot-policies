package compliance_framework.vulnerability_dismissal_count

violation[{}] if {
	# Build a set of alerts that have been dismissed_alerts
	dismissed_alerts := [alert |
		alert := input.alerts[_]
		alert.dismissed_at != null
	]

	# If there are 10 or more dismissed alerts, deny
	count(dismissed_alerts) >= 10
}

title := "Limit number of dismissed vulnerabilities"
description := "More than 10 dismissed vulnerabilities may indicate a misuse of 'false positive' or that valid risk is being ignored."
