package vulnerability_dismissal_count

violation[{}] if {
	# Build a set of alerts that have been dismissed
	dismissed_alerts := [alert |
		some alert in input.alerts
		alert.state == "dismissed"
	]

	count(dismissed_alerts) >= 10
}

title := "Limit number of dismissed vulnerabilities"
description := `
More than 10 dismissed vulnerabilities may indicate 
 a misuse of 'false positive' or that valid risk is being ignored.
`
