package vulnerability_dismissal_count_test

import data.vulnerability_dismissal_count

test_no_vulnerabilities_ok if {
	count(vulnerability_dismissal_count.violation) == 0 with input as {"alerts": []}
}

test_few_vulnerabilities_ok if {
	count(vulnerability_dismissal_count.violation) == 0 with input as {"alerts": [
		{"state": "closed"},
		{"state": "dismissed"},
		{"state": "open"},
	]}
}

test_nine_vulnerabilities_ok if {
	count(vulnerability_dismissal_count.violation) == 0 with input as {"alerts": [
		{"state": "closed"},
		{"state": "dismissed"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
		{"state": "open"},
	]}
}

test_ten_dismissed_vulnerabilities_violation if {
	count(vulnerability_dismissal_count.violation) == 1 with input as {"alerts": [
		{"state": "closed"},
		{"state": "open"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
	]}
}

test_eleven_vulnerabilities_violation if {
	count(vulnerability_dismissal_count.violation) == 1 with input as {"alerts": [
		{"state": "closed"},
		{"state": "open"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
		{"state": "dismissed"},
	]}
}
