package vulnerability_dismissal_date

ninety_days_ns := 7776000000000000

violation[{}] if {
	ninety_days_earlier := time.now_ns() - ninety_days_ns

	# Fail if one or more alerts have been dismissed for longer than 90 days
	some alert in input.alerts

	alert.dismissed_at != null
	time.parse_rfc3339_ns(alert.dismissed_at) < ninety_days_earlier
}

title := "Limit age of dismissed vulnerabilities"
description := "Vulnerabilities dismissed more than 90 days ago should be re-opened and re-assessed."
